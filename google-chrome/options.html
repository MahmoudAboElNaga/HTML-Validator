<html>
	<title>HTML Validator options</title>
	<style>
		#container {
			width: 500px;
			margin: 0 auto;
		}
	
		body {
			font: 13px Arial, sans-serif;
		}
		
		label {
			font-weight: bold;
			margin-right: 10px;
		}
		
		h1 {
			font-size: 20px;
		}
		
		h2 {
			font-size: 14px;
			margin: 30px 0 0;
		}
	</style>
	<script>
		var htmlvalidatoroptions = function () {
			// Base variables
			var backgroundPage = chrome.extension.getBackgroundPage().htmlvalidatorbackground,
			 	prefs = backgroundPage.getPrefs(),
				autorun,
				validator,
				popup,
				defaults = {
					autorun : "false",
					validator : "inline",
					popup : "popup"
				},
				item,
				pref,
				
				init = function () {
					autorun = document.getElementById("autorun");
					validator = document.getElementsByName("validator");
					popup = document.getElementsByName("popup");
					
					// Getting values from preferences	
					for (var item in prefs) {
						pref = prefs[item];
						if (typeof pref === "undefined") {
							pref = defaults[item];
							backgroundPage.setPref(item, pref);
						}
						if (item === "validator" || item === "popup") {
							document.getElementById(pref).checked = true;
						}
						else {
							document.getElementById(item).checked = (pref === "true");
						}
					}

					// Event to set preferences instantaneously
					document.onclick = function () {
						var validatorValue = "inline",
							validatorItem,
							popupValue = "popup",
							popupItem;
						for (var i=0, il=validator.length; i<il; i++) {
							validatorItem = validator[i];
							if (validatorItem.checked) {
								validatorValue = validatorItem.value;
								break;
							}
						};
						
						for (var j=0, jl=popup.length; j<jl; j++) {
							popupItem = popup[j];
							if (popupItem.checked) {
								popupValue = popupItem.value;
								break;
							}
						};
												
						// Save preferences
						backgroundPage.setPrefs({
							autorun : autorun.checked,
							validator : validatorValue,
							popup : popupValue
						});
					}
				};
				
			return {
				init : init
			}	
		}();
	
		window.onload = function () {
			htmlvalidatoroptions.init();
		};
	</script>
	
	<body>
		
		<div id="container">
			<h1>HTML Validator Options</h1>
			<h2>Autorun</h2>
			<p>
				<input type="checkbox" id="autorun">
				<label for="autorun">Autorun</label>
			</p>
			
			<h2>Validation Type</h2>
			<p>
				<input type="radio" id="inline" name="validator" value="inline">
				<label for="inline">Inline in page</label>
				<input type="radio" id="new-tab" name="validator" value="new-tab">
				<label for="new-tab">New tab with W3C validator</label>
			</p>
			
			<h2>Show menu at icon-click</h2>
			<p>
				<input type="radio" id="popup" name="popup" value="popup">
				<label for="popup">Yes</label>
				<input type="radio" id="no-popup" name="popup" value="no-popup">
				<label for="no-popup">No (will instead validate according to Validation Type)</label>
			</p>
			
			<h2>Keyboard shortcuts</h2>
			<p>
				<b>Windows/Linux:</b> Press Ctrl + Shift + V to validate a page<br>
				<b>Mac:</b> Press Cmd + Shift + V to validate a page<br>
			</p>
		</div>
		
	</body>
</html>